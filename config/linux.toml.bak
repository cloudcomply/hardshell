[accounts]
[accounts.0001a]
check_name = "/etc/passwd"
check_type = "path"
path = "/etc/passwd"
expected_gid = 0
expected_permissions = 644
expected_uid = 0
path_exists = true
valid_os = ["amzn-2023", "debian-12", "kali-2024.1", "ubuntu-22.04"]

[accounts.0002a]
check_name = "/etc/passwd-"
check_type = "path"
path = "/etc/passwd-"
expected_gid = 0
expected_permissions = 644
expected_uid = 0
path_exists = true
valid_os = ["amzn-2023", "debian-12", "kali-2024.1", "ubuntu-22.04"]

[accounts.0003a]
check_name = "/etc/group"
check_type = "path"
path = "/etc/group"
expected_gid = 0
expected_permissions = 644
expected_uid = 0
path_exists = true
valid_os = ["amzn-2023", "debian-12", "kali-2024.1", "ubuntu-22.04"]

[accounts.0004a]
check_name = "/etc/group-"
check_type = "path"
path = "/etc/group-"
expected_gid = 0
expected_permissions = 644
expected_uid = 0
path_exists = true
valid_os = ["amzn-2023", "debian-12", "kali-2024.1", "ubuntu-22.04"]

[accounts.0005a]
check_name = "/etc/shadow"
check_type = "path"
path = "/etc/shadow"
expected_gid = 0
expected_permissions = 0
expected_uid = 0
path_exists = true
valid_os = ["amzn-2023"]

[accounts.0005b]
check_name = "/etc/shadow"
check_type = "path"
path = "/etc/shadow"
expected_gid = 42
expected_permissions = 640
expected_uid = 0
path_exists = true
valid_os = ["debian-12", "kali-2024.1", "ubuntu-22.04"]

[accounts.0006a]
check_name = "/etc/shadow-"
check_type = "path"
path = "/etc/shadow-"
expected_gid = 0
expected_permissions = 0
expected_uid = 0
path_exists = true
valid_os = ["amzn-2023"]

[accounts.0006b]
check_name = "/etc/shadow-"
check_type = "path"
path = "/etc/shadow-"
expected_gid = 42
expected_permissions = 640
expected_uid = 0
path_exists = true
valid_os = ["debian-12", "kali-2024.1", "ubuntu-22.04"]

[accounts.0007a]
check_name = "/etc/gshadow"
check_type = "path"
path = "/etc/gshadow"
expected_gid = 0
expected_permissions = 0
expected_uid = 0
path_exists = true
valid_os = ["amzn-2023"]

[accounts.0007b]
check_name = "/etc/gshadow"
check_type = "path"
path = "/etc/gshadow"
expected_gid = 42
expected_permissions = 640
expected_uid = 0
path_exists = true
valid_os = ["debian-12", "kali-2024.1", "ubuntu-22.04"]

[accounts.0008a]
check_name = "/etc/gshadow-"
check_type = "path"
path = "/etc/gshadow-"
expected_gid = 0
expected_permissions = 0
expected_uid = 0
path_exists = true
valid_os = ["amzn-2023"]

[accounts.0008b]
check_name = "/etc/gshadow-"
check_type = "path"
path = "/etc/gshadow-"
expected_gid = 42
expected_permissions = 640
expected_uid = 0
path_exists = true
valid_os = ["debian-12", "kali-2024.1", "ubuntu-22.04"]

[aide]
[aide.0001a]
check_name = "aide"
check_type = "package"
package_name = "aide"
package_status = "install"
valid_os = ["amzn-2023", "ubuntu-22.04"]

[audit]
[audit.0001a]
check_name = "audit"
check_type = "package"
package_name = "audit"
package_status = "install"
valid_os = ["amzn-2023"]

[audit.0001b]
check_name = "auditd"
check_type = "package"
package_name = "auditd"
package_status = "install"
valid_os = ["ubuntu-22.04"]

[banners]
[banners.0001a]
check_name = "/etc/motd"
check_type = "path"
path = "/etc/motd"
expected_gid = 0
expected_permissions = 644
expected_uid = 0
path_exists = true
valid_os = ["amzn-2023", "ubuntu-22.04"]

[banners.0002a]
check_name = "/etc/issue"
check_type = "path"
path = "/etc/issue"
expected_gid = 0
expected_permissions = 644
expected_uid = 0
path_exists = true
valid_os = ["amzn-2023", "ubuntu-22.04"]

[banners.0003a]
check_name = "/etc/issue.net"
check_type = "path"
path = "/etc/issue.net"
expected_gid = 0
expected_permissions = 644
expected_uid = 0
path_exists = true
valid_os = ["amzn-2023", "ubuntu-22.04"]


[mounts]
[mounts.0001a]
check_name = "/tmp"
check_type = "mount"
mount_exists = true
nodev = true
noexec = true
nosuid = true
path = "/tmp"
separate_partition = true
valid_os = ["amzn-2023", "ubuntu-22.04"]

[mounts.0001b]
check_name = "/tmp mount options not set"
check_type = "mount-options"
path = "/tmp"
mount_options = ["nodev", "noexec", "nosuid"]
valid_os = ["amzn-2023", "ubuntu-22.04"]

[mounts.0002a]
check_name = "/var"
check_type = "mount"
mount_exists = true
nodev = true
noexec = true
nosuid = true
path = "/var"
separate_partition = true
valid_os = ["amzn-2023", "ubuntu-22.04"]

[mounts.0002b]
check_name = "/var mount options not set"
check_type = "mount-options"
path = "/var"
mount_options = ["nodev", "nosuid"]
valid_os = ["amzn-2023", "ubuntu-22.04"]

[mounts.0003a]
check_name = "/var/tmp separate partition"
check_type = "mount-point"
path = "/var/tmp"
valid_os = ["amzn-2023", "ubuntu-22.04"]

[mounts.0003b]
check_name = "/var/tmp mount options not set"
check_type = "mount-options"
path = "/var/tmp"
mount_options = ["nodev", "noexec", "nosuid"]
valid_os = ["amzn-2023", "ubuntu-22.04"]

[mounts.0004a]
check_name = "/var/log separate partition"
check_type = "mount-point"
path = "/var/log"
valid_os = ["amzn-2023", "ubuntu-22.04"]

[mounts.0004b]
check_name = "/var/log mount options not set"
check_type = "mount-options"
path = "/var/log"
mount_options = ["nodev", "noexec", "nosuid"]
valid_os = ["amzn-2023", "ubuntu-22.04"]

[mounts.0005a]
check_name = "/var/log/audit separate partition"
check_type = "mount-point"
path = "/var/log/audit"
valid_os = ["amzn-2023", "ubuntu-22.04"]

[mounts.0005b]
check_name = "/var/log/audit mount options not set"
check_type = "mount-options"
path = "/var/log/audit"
mount_options = ["nodev", "noexec", "nosuid"]
valid_os = ["amzn-2023", "ubuntu-22.04"]

[mounts.0006a]
check_name = "/home separate partition"
check_type = "mount-point"
path = "/home"
valid_os = ["amzn-2023", "ubuntu-22.04"]

[mounts.0006b]
check_name = "/home mount options not set"
check_type = "mount-options"
path = "/home"
mount_options = ["nodev", "nosuid"]
valid_os = ["amzn-2023", "ubuntu-22.04"]

[mounts.0007a]
check_name = "/dev/shm separate partition"
check_type = "mount-point"
path = "/dev/shm"
mount_options = ["nodev", "noexec", "nosuid"]
valid_os = ["amzn-2023", "ubuntu-22.04"]

[mounts.0007b]
check_name = "/dev/shm mount options not set"
check_type = "mount-options"
path = "/dev/shm"
mount_options = ["nodev", "noexec", "nosuid"]
valid_os = ["amzn-2023", "ubuntu-22.04"]


[mounts.000000000000000000001a]
check_name = "/mnt/bindmounttest"
check_type = "mount"
mount_exists = true
nodev = true
noexec = true
nosuid = true
path = "/mnt/bindmounttest"
separate_partition = false
valid_os = ["amzn-2023", "ubuntu-22.04"]


[kernel_module]
[kernel_module.0001a]
check_name = "cramfs"
check_type = "module"
module_name = "cramfs"
module_type = "filesystem"
module_blacklisted = true
module_denied = true
module_loadable = false
module_loaded = false
valid_os = ["amzn-2023", "ubuntu-22.04"]

[kernel_module.0002a]
check_name = "dccp"
check_type = "module"
module_name = "dccp"
module_type = "network"
module_blacklisted = true
module_denied = true
module_loadable = false
module_loaded = false
valid_os = ["amzn-2023", "ubuntu-22.04"]

[kernel_module.0003a]
check_name = "freevxfs"
check_type = "module"
module_name = "freevxfs"
module_type = "filesystem"
module_blacklisted = true
module_denied = true
module_loadable = false
module_loaded = false
valid_os = ["amzn-2023", "ubuntu-22.04"]

[kernel_module.0004a]
check_name = "hfs"
check_type = "module"
module_name = "hfs"
module_type = "filesystem"
module_blacklisted = true
module_denied = true
module_loadable = false
module_loaded = false
valid_os = ["amzn-2023", "ubuntu-22.04"]

[kernel_module.0005a]
check_name = "hfsplus"
check_type = "module"
module_name = "hfsplus"
module_type = "filesystem"
module_blacklisted = true
module_denied = true
module_loadable = false
module_loaded = false
valid_os = ["ubuntu-22.04"]

[kernel_module.0006a]
check_name = "jffs2"
check_type = "module"
module_name = "jffs2"
module_type = "filesystem"
module_blacklisted = true
module_denied = true
module_loadable = false
module_loaded = false
valid_os = ["amzn-2023", "ubuntu-22.04"]

[kernel_module.0007a]
check_name = "rds"
check_type = "module"
module_name = "rds"
module_type = "network"
module_blacklisted = true
module_denied = true
module_loadable = false
module_loaded = false
valid_os = ["amzn-2023", "ubuntu-22.04"]

[kernel_module.0008a]
check_name = "sctp"
check_type = "module"
module_name = "sctp"
module_type = "network"
module_blacklisted = true
module_denied = true
module_loadable = false
module_loaded = false
valid_os = ["amzn-2023", "ubuntu-22.04"]

[kernel_module.0009a]
check_name = "squashfs"
check_type = "module"
module_name = "squashfs"
module_type = "filesystem"
module_blacklisted = true
module_denied = true
module_loadable = false
module_loaded = false
valid_os = ["amzn-2023", "ubuntu-22.04"]

[kernel_module.0010a]
check_name = "tipc"
check_type = "module"
module_name = "tipc"
module_type = "network"
module_blacklisted = true
module_denied = true
module_loadable = false
module_loaded = false
valid_os = ["amzn-2023", "ubuntu-22.04"]

[kernel_module.0011a]
check_name = "udf"
check_type = "module"
module_name = "udf"
module_type = "filesystem"
module_blacklisted = true
module_denied = true
module_loadable = false
module_loaded = false
valid_os = ["amzn-2023", "ubuntu-22.04"]

[kernel_module.0012a]
check_name = "usb-storage"
check_type = "module"
module_name = "usb-storage"
module_type = "storage"
module_blacklisted = true
module_denied = true
module_loadable = false
module_loaded = false
valid_os = ["amzn-2023", "ubuntu-22.04"]

[kernel_module.0000001a]
check_name = "falcon_lsm_serviceable"
check_type = "module"
module_name = "falcon_lsm_serviceable"
module_type = "storage"
module_blacklisted = false
module_denied = false
module_loadable = true
module_loaded = true
valid_os = ["amzn-2023", "ubuntu-22.04"]

[kernel_parameters]
[kernel_parameters.0001a]
check_name = "net.ipv4.ip_forward"
check_type = "parameter"
parameter = "net.ipv4.ip_forward = 0"
valid_os = ["amzn-2023", "ubuntu-22.04"]

[rsyslog]
[rsyslog.0001a]
check_name = "rsyslog"
check_type = "package"
package_name = "rsyslog"
package_status = "install"
valid_os = ["amzn-2023"]


[packages]
[packages.0001a]
check_name = "avahi"
check_type = "package"
package_name = "avahi"
package_status = "remove"
valid_os = ["amzn-2023"]

[packages.0001b]
check_name = "avahi-daemon"
check_type = "package"
package_name = "avahi-daemon"
package_status = "remove"
valid_os = ["ubuntu-22.04"]

[packages.0002a]
check_name = "bind"
check_type = "package"
package_name = "bind"
package_status = "remove"
valid_os = ["amzn-2023"]

[packages.0002b]
check_name = "bind9"
check_type = "package"
package_name = "bind9"
package_status = "remove"
valid_os = ["ubuntu-22.04"]

[packages.0003a]
check_name = "cups"
check_type = "package"
package_name = "cups"
package_status = "remove"
valid_os = ["amzn-2023", "ubuntu-22.04"]

[packages.0004a]
check_name = "dnsmasq"
check_type = "package"
package_name = "dnsmasq"
package_status = "remove"
valid_os = ["amzn-2023", "ubuntu-22.04"]

[packages.0005a]
check_name = "dovecot"
check_type = "package"
package_name = "dovecot"
package_status = "remove"
valid_os = ["amzn-2023"]

[packages.0006a]
check_name = "httpd"
check_type = "package"
package_name = "httpd"
package_status = "remove"
valid_os = ["amzn-2023"]

[packages.0007a]
check_name = "net-snmp"
check_type = "package"
package_name = "net-snmp"
package_status = "remove"
valid_os = ["amzn-2023"]

[packages.0008a]
check_name = "nfs-utils"
check_type = "package"
package_name = "nfs-utils"
package_status = "remove"
valid_os = ["amzn-2023"]

[packages.0009a]
check_name = "nginx"
check_type = "package"
package_name = "nginx"
package_status = "remove"
valid_os = ["amzn-2023", "ubuntu-22.04"]

[packages.0010a]
check_name = "openldap-clients"
check_type = "package"
package_name = "openldap-clients"
package_status = "remove"
valid_os = ["amzn-2023"]

[packages.0011a]
check_name = "rpcbind"
check_type = "package"
package_name = "rpcbind"
package_status = "remove"
valid_os = ["amzn-2023", "ubuntu-22.04"]

[packages.0012a]
check_name = "rsync-daemon"
check_type = "package"
package_name = "rsync-daemon"
package_status = "remove"
valid_os = ["amzn-2023"]

[packages.0013a]
check_name = "samba"
check_type = "package"
package_name = "samba"
package_status = "remove"
valid_os = ["amzn-2023", "ubuntu-22.04"]

[packages.0014a]
check_name = "squid"
check_type = "package"
package_name = "squid"
package_status = "remove"
valid_os = ["amzn-2023", "ubuntu-22.04"]

[packages.0015a]
check_name = "telnet"
check_type = "package"
package_name = "telnet"
package_status = "remove"
valid_os = ["amzn-2023"]

[packages.0016a]
check_name = "telnet-server"
check_type = "package"
package_name = "telnet-server"
package_status = "remove"
valid_os = ["amzn-2023"]

[packages.0017a]
check_name = "vsftpd"
check_type = "package"
package_name = "vsftpd"
package_status = "remove"
valid_os = ["amzn-2023", "ubuntu-22.04"]

[packages.0018a]
check_name = "xorg-x11-server-common"
check_type = "package"
package_name = "xorg-x11-server-common"
package_status = "remove"
valid_os = ["amzn-2023"]

# Testing package
# [packages.000001a]
# check_name = "xauth"
# check_type = "package"
# package_name = "xauth"
# package_status = "remove"
# valid_os = ["amzn-2023", "ubuntu-22.04"]


[services]
[services.00000001a]
check_name = "avahi-daemon.service"
check_type = "service"
service_name = "avahi-daemon.service"
service_active = false
service_enabled = false
service_masked = true
valid_os = ["amzn-2023", "ubuntu-22.04"]

[at]
[at.0001a]
check_name = "at"
check_type = "package"
package_name = "at"
package_status = "install"
valid_os = ["amzn-2023", "ubuntu-22.04"]

[at.0002a]
check_name = "atd.service"
check_type = "service"
service_name = "atd.service"
service_status = "enabled"
service_active = true
service_enabled = true
service_masked = false
valid_os = ["amzn-2023", "ubuntu-22.04"]

[at.0003a]
check_name = "/etc/at.allow"
check_type = "path"
path = "/etc/at.allow"
expected_gid = 0
expected_permissions = 700
expected_uid = 0
path_exists = true
valid_os = ["amzn-2023", "ubuntu-22.04"]

[at.0004a]
check_name = "/etc/at.deny"
check_type = "file-exists"
path = "/etc/at.deny"
expected_gid = 0
expected_permissions = 700
expected_uid = 0
path_exists = false
valid_os = ["amzn-2023", "ubuntu-22.04"]

[cron]
[cron.0001a]
check_name = "cronie"
check_type = "package"
package_name = "cronie"
package_status = "install"
valid_os = ["amzn-2023"]

[cron.0001b]
check_name = "cron"
check_type = "package"
package_name = "cron"
package_status = "install"
valid_os = ["ubuntu-22.04"]

[cron.0002a]
check_name = "cron.service"
check_type = "service"
service_name = "cron.service"
service_active = true
service_enabled = true
service_masked = false
valid_os = ["amzn-2023", "ubuntu-22.04"]

[cron.0000000001a]
check_name = "cron2.service"
check_type = "service"
service_name = "cron2.service"
service_active = false
service_enabled = false
service_masked = true
valid_os = ["amzn-2023", "ubuntu-22.04"]

[cron.0003a]
check_name = "/etc/cron.allow"
check_type = "path"
path = "/etc/cron.allow"
expected_gid = 0
expected_permissions = 700
expected_uid = 0
path_exists = true
valid_os = ["amzn-2023", "ubuntu-22.04"]

[cron.0004a]
check_name = "/etc/cron.deny"
check_type = "path"
path = "/etc/cron.deny"
expected_gid = 0
expected_permissions = 700
expected_uid = 0
path_exists = false
valid_os = ["amzn-2023", "ubuntu-22.04"]

[cron.0005a]
check_name = "/etc/crontab"
check_type = "path"
path = "/etc/crontab"
expected_gid = 0
expected_permissions = 600
expected_uid = 0
path_exists = true
valid_os = ["amzn-2023", "ubuntu-22.04"]

[cron.0006a]
check_name = "/etc/cron.hourly"
check_type = "path"
path = "/etc/cron.hourly"
expected_gid = 0
expected_permissions = 700
expected_uid = 0
path_exists = true
valid_os = ["amzn-2023", "ubuntu-22.04"]

[cron.0007a]
check_name = "/etc/cron.daily"
check_type = "path"
path = "/etc/cron.daily"
expected_gid = 0
expected_permissions = 700
expected_uid = 0
path_exists = true
valid_os = ["amzn-2023", "ubuntu-22.04"]

[cron.0008a]
check_name = "/etc/cron.weekly"
check_type = "path"
path = "/etc/cron.weekly"
expected_gid = 0
expected_permissions = 700
expected_uid = 0
path_exists = true
valid_os = ["amzn-2023", "ubuntu-22.04"]

[cron.0009a]
check_name = "/etc/cron.monthly"
check_type = "path"
path = "/etc/cron.monthly"
expected_gid = 0
expected_permissions = 700
expected_uid = 0
path_exists = true
valid_os = ["amzn-2023", "ubuntu-22.04"]

[cron.0010a]
check_name = "/etc/cron.d"
check_type = "path"
path = "/etc/cron.d"
expected_gid = 0
expected_permissions = 700
expected_uid = 0
path_exists = true
valid_os = ["amzn-2023", "ubuntu-22.04"]


[selinux]
[selinux.0001a]
check_name = "libselinux"
check_type = "package"
package_name = "libselinux"
package_status = "install"
valid_os = ["amzn-2023"]

[sudo]
[sudo.0001a]
check_name = "sudo"
check_type = "package"
package_name = "sudo"
package_status = "install"
valid_os = ["amzn-2023", "ubuntu-22.04"]

[chrony]
[chrony.0001a]
check_name = "chrony"
check_type = "package"
package_name = "chrony"
package_status = "install"
valid_os = ["amzn-2023", "ubuntu-22.04"]

[systemd-timesyncd]
[systemd-timesyncd.0001a]
check_name = "systemd-timesyncd"
check_type = "package"
package_name = "systemd-timesyncd"
package_status = "install"
valid_os = ["ubuntu-22.04"]

# Old Checks

# [cron.000000001a]
# check_name = "/etc/cron.allow"
# check_type = "file"
# path = "/etc/cron.allow"
# expected_gid = 0
# expected_permissions = 600
# expected_uid = 0
# file_exists = true
# valid_os = ["amzn-2023", "ubuntu-22.04"]

# [cron.000000002a]
# check_name = "/etc/crontab"
# check_type = "file"
# path = "/etc/crontab"
# expected_gid = 0
# expected_permissions = 600
# expected_uid = 0
# file_exists = true
# valid_os = ["amzn-2023", "ubuntu-22.04"]

#################################################
# Global Configuration
#################################################
[global]
# modprobe Configuration File Location
modprobe_config = "/etc/modprobe.d/"
# sysctl Configuration Files Location
sysctl_config = "/etc/sysctl.d/"
sysctl_config_prefix = "10-"
# Uncomment the following to check_set your own sysctl config file name
#sysctl_config_file = "10-denylist.conf"
[global.commands]
find_mount = ["findmnt", "-nk"]

[global.pkg_mgr]
amzn.manager = 'dnf'
amzn.installed = ['dnf', 'list', '--installed']
amzn.uninstall = ['dnf', 'remove']

centos.manager = 'yum'
centos.installed = ['yum', 'list']
centos.uninstall = ['yum', 'remove']

debian.manager = 'apt'
debian.installed = ['apt', 'list']
debian.uninstall = ['apt', 'remove']

fedora.manager = 'dnf'
fedora.installed = ['dnf', 'list', '--installed']
fedora.uninstall = ['dnf', 'remove']

rhel.manager = ''
rhel.installed = []
rhel.uninstall = []

sles.manager = ''
sles.installed = []
sles.uninstall = []

ubuntu.manager = 'apt'
ubuntu.installed = ['apt', 'list']
ubuntu.uninstall = ['apt', 'remove']

#################################################
# Kernel Hardening
#################################################
[kernel]
category_skip = false
category_set = true

#################################################
# Filesystem Checks
#################################################
[kernel.filesystem]
category_skip = false
category_set = true

[kernel.filesystem.cramfs]
check_skip = false
check_set = true
check_type = "filesystem"
cis = "level-2"
disa = ""
mitre = "T1005,T1005.000 TA0005 M1050"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-7"

[kernel.filesystem.fat]
check_skip = false
check_set = false
check_type = "filesystem"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[kernel.filesystem.freevxfs]
check_skip = false
check_set = true
check_type = "filesystem"
cis = "level-1"
disa = ""
mitre = "T1005,T1005.000 TA0005 M1050"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-7"

[kernel.filesystem.gfs2]
check_skip = false
check_set = false
check_type = "filesystem"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[kernel.filesystem.hfs]
check_skip = false
check_set = true
check_type = "filesystem"
cis = "level-1"
disa = ""
mitre = "T1005,T1005.000 TA0005 M1050"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-7"

[kernel.filesystem.hfsplus]
check_skip = false
check_set = true
check_type = "filesystem"
cis = "level-1"
disa = ""
mitre = "T1005,T1005.000 TA0005 M1050"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-7"

[kernel.filesystem.jffs2]
check_skip = false
check_set = true
check_type = "filesystem"
cis = "level-1"
disa = ""
mitre = "T1005,T1005.000 TA0005 M1050"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-7"

[kernel.filesystem.nfs]
check_skip = true
check_set = false
check_type = "filesystem"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[kernel.filesystem.nfsv3]
check_skip = true
check_set = false
check_type = "filesystem"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[kernel.filesystem.squashfs]
check_skip = false
check_set = true
check_type = "filesystem"
cis = "level-2"
disa = ""
mitre = "T1005,T1005.000 TA0005 M1050"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-7"

[kernel.filesystem.udf]
check_skip = false
check_set = true
check_type = "filesystem"
cis = "level-2"
disa = ""
mitre = "T1005,T1005.000 TA0005 M1050"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-7"

[kernel.filesystem.usb-storage]
check_skip = false
check_set = true
check_type = "filesystem"
cis = ""
disa = ""
mitre = "T1052,T1052.001,T1091,T1091.000,T1200,T1200.000 TA0001,TA0010 M1034"
stig = ""
source = ""

[kernel.filesystem.vfat]
check_skip = false
check_set = false
check_type = "filesystem"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

#################################################
# Module Checks
#################################################
[kernel.module]
category_skip = false
category_set = true

[kernel.module.dccp]
check_skip = false
check_set = true
check_type = "module"
cis = "level-2"
disa = ""
mitre = "T1068,T1068.000,T1210,T1210.000 TA0008 M1042"
stig = ""
source = "NIST SP 800-53 Rev. 5: SI-4, CM-7"

[kernel.module.rds]
check_skip = false
check_set = true
check_type = "module"
cis = "level-2"
disa = ""
mitre = "T1068,T1068.000,T1210,T1210.000 TA0008 M1042"
stig = ""
source = "NIST SP 800-53 Rev. 5: SI-4, CM-7"

[kernel.module.sctp]
check_skip = false
check_set = true
check_type = "module"
cis = "level-2"
disa = ""
mitre = "T1068,T1068.000,T1210,T1210.000 TA0008 M1042"
stig = ""
source = "NIST SP 800-53 Rev. 5: SI-4, CM-7"

[kernel.module.tipc]
check_skip = false
check_set = true
check_type = "module"
cis = "level-2"
disa = ""
mitre = "T1068,T1068.000,T1210,T1210.000 TA0008 M1042"
stig = ""
source = "NIST SP 800-53 Rev. 5: SI-4, CM-7"

#################################################
# Parameter Checks
#################################################
[kernel.parameter]
category_skip = false
category_set = true

[kernel.parameter.aslr]
check_skip = false
check_set = true
check_type = "parameter"
settings = ["kernel.randomize_va_space = 2"]
cis = "level-1"
disa = "CCI-000366"
mitre = "T1068,T1068.000 TA0002 M1050"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-6"

[kernel.parameter.ptrace]
check_skip = false
check_set = true
check_type = "parameter"
settings = ["kernel.yama.ptrace_scope = 1"]
cis = "level-1"
disa = ""
mitre = "T1055.008 TA0005 M1040"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-6"


#################################################
# Network Checks
#################################################
[kernel.network]
category_skip = false
category_set = true

# IPv4
[kernel.network.ipv4forward]
check_skip = false
check_set = true
check_type = "network"
settings = ["net.ipv4.ip_forward = 0"]
cis = "level-1"
disa = ""
mitre = "T1557,T1557.000 TA0006,TA0009 M1030,M1042"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.ipv4sendredirects]
check_skip = false
check_set = true
check_type = "network"
settings = [
    "net.ipv4.conf.all.send_redirects = 0",
    "net.ipv4.conf.default.send_redirects = 0",
]
cis = "level-1"
disa = ""
mitre = "T1557,T1557.000 TA0006,TA0009 M1030,M1042"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.ipv4sourcerouteaccept]
check_skip = false
check_set = true
check_type = "network"
settings = [
    "net.ipv4.conf.all.accept_source_route = 0",
    "net.ipv4.conf.default.accept_source_route = 0",
]
cis = "level-1"
disa = ""
mitre = "T1590,T1590.005 TA0007"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.ipv4icmpredirectaccept]
check_skip = false
check_set = true
check_type = "network"
settings = [
    "net.ipv4.conf.all.accept_redirects = 0",
    "net.ipv4.conf.default.accept_redirects = 0",
]
cis = "level-1"
disa = ""
mitre = "T1557,T1557.000 TA0006,TA0009 M1030,M1042"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.ipv4icmpsecureredirectaccept]
check_skip = false
check_set = true
check_type = "network"
settings = [
    "net.ipv4.conf.all.secure_redirects = 0",
    "net.ipv4.conf.default.secure_redirects = 0",
]
cis = "level-1"
disa = ""
mitre = "T1557,T1557.000 TA0006,TA0009 M1030,M1042"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.suspectpacketslogged]
check_skip = false
check_set = true
check_type = "network"
settings = [
    "net.ipv4.conf.all.log_martians = 1",
    "net.ipv4.conf.default.log_martians = 1",
]
cis = "level-1"
disa = ""
mitre = "T1562,T1562.006 TA0005"
stig = ""
source = "NIST SP 800-53 Rev. 5: AU-3"

[kernel.network.ignorebroadcastrequests]
check_skip = false
check_set = true
check_type = "network"
settings = ["net.ipv4.icmp_echo_ignore_broadcasts = 1"]
cis = "level-1"
disa = ""
mitre = "T1498,T1498.001 TA0040 M1037"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.ignorebogusicmpresponse]
check_skip = false
check_set = true
check_type = "network"
settings = ["net.ipv4.icmp_ignore_bogus_error_responses = 1"]
cis = "level-1"
disa = ""
mitre = "T1562,T1562.006 TA0040 M1053"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.reversepathfilter]
check_skip = false
check_set = true
check_type = "network"
settings = [
    "net.ipv4.conf.all.rp_filter = 1",
    "net.ipv4.conf.default.rp_filter = 1",
]
cis = "level-1"
disa = ""
mitre = "T1498,T1498.001 TA0006,TA0040 M1030,M1042"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5"

[kernel.network.tcpsyncookies]
check_skip = false
check_set = true
check_type = "network"
settings = ["net.ipv4.tcp_syncookies = 1"]
cis = "level-1"
disa = ""
mitre = "T1499,T1499.001 TA0040 M1037"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5"

# IPv6
[kernel.network.ipv6forward]
check_skip = false
check_set = true
check_type = "network"
settings = ["net.ipv6.conf.all.forwarding = 0"]
cis = "level-1"
disa = ""
mitre = "T1557,T1557.000 TA0006,TA0009 M1030,M1042"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.ipv6sourcerouteaccept]
check_skip = false
check_set = true
check_type = "network"
settings = [
    "net.ipv6.conf.all.accept_source_route = 0",
    "net.ipv6.conf.default.accept_source_route = 0",
]
cis = "level-1"
disa = ""
mitre = "T1590,T1590.005 TA0007"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.ipv6icmpredirectaccept]
check_skip = false
check_set = true
check_type = "network"
settings = [
    "net.ipv6.conf.all.accept_redirects = 0",
    "net.ipv6.conf.default.accept_redirects = 0",
]
cis = "level-1"
disa = ""
mitre = "T1557,T1557.000 TA0006,TA0009 M1030,M1042"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.ipv6routeradvertisement]
check_skip = false
check_set = true
check_type = "network"
settings = [
    "net.ipv6.conf.all.accept_ra = 0",
    "net.ipv6.conf.default.accept_ra = 0",
]
cis = "level-1"
disa = ""
mitre = "T1557,T1557.000 TA0006,TA0040 M1030,M1042"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5"

#################################################
# System Hardening
#################################################
[system]
category_skip = false
category_set = true

#################################################
# Storage Checks
#################################################
[system.storage]
category_skip = false
category_set = true

[system.storage.devshm]
check_skip = false
check_set = true
path = "/dev/shm"
options = ["nodev", "noexec", "nosuid"]

[system.storage.home]
check_skip = false
check_set = true
path = "/home"
options = ["nodev", "nosuid"]

[system.storage.tmp]
check_skip = false
check_set = true
path = "/tmp"
options = ["nodev", "noexec", "nosuid"]

[system.storage.var]
check_skip = false
check_set = true
path = "/var"
options = ["nodev", "nosuid"]

[system.storage.varlog]
check_skip = false
check_set = true
path = "/var/log"
options = ["nodev", "noexec", "nosuid"]

[system.storage.varlogaudit]
check_skip = false
check_set = true
path = "/var/log/audit"
options = ["nodev", "noexec", "nosuid"]

[system.storage.vartmp]
check_skip = false
check_set = true
path = "/var/tmp"
options = ["nodev", "noexec", "nosuid"]

#################################################
# Package Checks
#################################################
[system.package]
category_skip = false
category_set = true

########################
# Admin Packages 
########################

[system.package.aide]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "admin"
cis = "level-1"
disa = ""
mitre = "T1565,T1565.001 TA0001 M1022"
stig = ""
source = "NIST SP 800-53 Rev. 5: AU-2"

[system.package.audit]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "admin"
cis = "level-2"
disa = ""
mitre = "T1562,T1562.001 TA0005"
stig = ""
source = "NIST SP 800-53 Rev. 5: AU-2, AU-3, AU-12, SI-5"

[system.package.auditd]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "admin"
cis = "level-2"
disa = ""
mitre = "T1562,T1562.001 TA0005"
stig = ""
source = "NIST SP 800-53 Rev. 5: AU-2, AU-3, AU-12, SI-5"

[system.package.chrony]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "admin"
cis = "level-1"
disa = ""
mitre = "T1070,T1070.002,T1562,T1562.001 TA0005 M1022"
stig = ""
source = "NIST SP 800-53 Rev. 5: AU-3, AU-12"

[system.package.cron]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "admin"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.cronie]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "admin"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.libselinux]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "admin"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.mcstrans]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "admin"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.ntp]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "admin"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.rsyslog]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "admin"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.sudo]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "admin"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.systemd-journal-remote]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "admin"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

########################
# Client Packages
########################

[system.package.ftp]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "client"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.openldap-clients]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "client"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.telnet]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "client"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.telnet-client]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "client"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

########################
# Libs Packages 
########################

[system.package.nfs-utils]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "libs"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.libnfs-utils]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "libs"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""


########################
# Mail Packages 
########################

[system.package.dovecot]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "mail"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.dovecot-core]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "mail"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

########################
# Net Packages 
########################

[system.package.avahi]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = "T1203,T1203.000,T1210,T1210.000,T1543,T1543.002 TA0008 M1042"
stig = ""
source = ""

[system.package.avahi-daemon]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = "T1203,T1203.000,T1210,T1210.000,T1543,T1543.002 TA0008 M1042"
stig = ""
source = ""

[system.package.bind]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.bind9]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.cups]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.dnsmasq]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.net-snmp]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.nftables]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.openssh-server]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.rpcbind]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.rsync]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.rsync-daemon]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.samba]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.snmp]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.snmpd]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.telnetd]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.telnet-server]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.tftpd]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.tftp-server]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.vsftpd]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "net"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

########################
# Utilities Packages 
########################

[system.package.authselect]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "utilities"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.sssd]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "utilities"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

########################
# Web Packages 
########################

[system.package.apache2]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "web"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.httpd]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "web"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.nginx]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "web"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.squid]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "web"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.test-nginx]
check_skip = true
check_set = true
check_type = "package"
pkg_type = "web"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

[system.package.test-squid]
check_skip = false
check_set = false
check_type = "package"
pkg_type = "web"
cis = ""
disa = ""
mitre = ""
stig = ""
source = ""

########################
# X11 Packages 
########################

[system.package.xorg]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "x11"
cis = "level-2"
disa = ""
mitre = "T1203,T1203.000,T1210,T1210.000,T1543,T1543.002 TA0008 M1042"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-7"

[system.package.xorg-x11-server-common]
check_skip = false
check_set = true
check_type = "package"
pkg_type = "x11"
cis = "level-2"
disa = ""
mitre = "T1203,T1203.000,T1210,T1210.000,T1543,T1543.002 TA0008 M1042"
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-7"


########################
# Unused 
########################

# [packages.setroubleshoot]


[test1]
category_skip = true
category_set = true

[test2]
category_skip = false
category_set = false

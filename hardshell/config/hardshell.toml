#################################################
# Global Configuration
#################################################
[global]
# modprobe Configuration File Location
modprobe_config = "/etc/modprobe.d/"
# sysctl Configuration Files Location
sysctl_config = "/etc/sysctl.d/"
sysctl_config_prefix = "10-"
# Uncomment the following to check_set your own sysctl config file name
#sysctl_config_file = "10-denylist.conf"
[global.commands]
find_mount = ["findmnt", "-nk"]
svc_enable = ["systemctl", "--now", "enable"]
svc_enabled = ["systemctl", "is-enabled"]
svc_status = ["systemctl", "status"]

[global.pkg_mgr]
amzn.manager = 'dnf'
amzn.installed = ['dnf', 'list', '--installed']
amzn.uninstall = ['dnf', 'remove']

centos.manager = 'yum'
centos.installed = ['yum', 'list']
centos.uninstall = ['yum', 'remove']

debian.manager = 'apt'
debian.installed = ['apt', 'list']
debian.uninstall = ['apt', 'remove']

fedora.manager = 'dnf'
fedora.installed = ['dnf', 'list', '--installed']
fedora.uninstall = ['dnf', 'remove']

rhel.manager = ''
rhel.installed = []
rhel.uninstall = []

sles.manager = ''
sles.installed = []
sles.uninstall = []

ubuntu.manager = 'apt'
ubuntu.installed = ['apt', 'list']
ubuntu.uninstall = ['apt', 'remove']

#################################################
# Kernel Hardening
#################################################
[kernel]
category_id = "KERNEL"
category_name = "Kernel"
category_skip = false
category_set = true

#################################################
# Filesystem Checks
#################################################
[kernel.filesystem]
sub_category_id = "FS"
sub_category_name = "File System"
sub_category_skip = false
sub_category_set = true

[kernel.filesystem.001]
check_id = "L-KERNEL-FS-001"
check_name = "cramfs"
check_skip = false
check_set = true
check_type = "filesystem"
cis = "level-2"
disa = ""
mitre_tec = ["T1005", "T1005.000"]
mitre_tac = ["TA0005"]
mitre_mit = ["M1050"]
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-7"

[kernel.filesystem.002]
check_id = "L-KERNEL-FS-001"
check_name = "fat"
check_skip = false
check_set = false
check_type = "filesystem"
cis = ""
disa = ""
mitre_tec = []
mitre_tac = []
mitre_mit = []
stig = ""
source = ""

[kernel.filesystem.003]
check_id = "L-KERNEL-FS-001"
check_name = "freevxfs"
check_skip = false
check_set = true
check_type = "filesystem"
cis = "level-1"
disa = ""
mitre_tec = ["T1005", "T1005.000"]
mitre_tac = ["TA0005"]
mitre_mit = ["M1050"]
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-7"

[kernel.filesystem.004]
check_id = "L-KERNEL-FS-001"
check_name = "gfs2"
check_skip = false
check_set = false
check_type = "filesystem"
cis = ""
disa = ""
mitre_tec = []
mitre_tac = []
mitre_mit = []
stig = ""
source = ""

[kernel.filesystem.005]
check_id = "L-KERNEL-FS-001"
check_name = "hfs"
check_skip = false
check_set = true
check_type = "filesystem"
cis = "level-1"
disa = ""
mitre_tec = ["T1005", "T1005.000"]
mitre_tac = ["TA0005"]
mitre_mit = ["M1050"]
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-7"

[kernel.filesystem.006]
check_id = "L-KERNEL-FS-001"
check_name = "hfsplus"
check_skip = false
check_set = true
check_type = "filesystem"
cis = "level-1"
disa = ""
mitre_tec = ["T1005", "T1005.000"]
mitre_tac = ["TA0005"]
mitre_mit = ["M1050"]
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-7"

[kernel.filesystem.007]
check_id = "L-KERNEL-FS-001"
check_name = "jffs2"
check_skip = false
check_set = true
check_type = "filesystem"
cis = "level-1"
disa = ""
mitre_tec = ["T1005", "T1005.000"]
mitre_tac = ["TA0005"]
mitre_mit = ["M1050"]
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-7"

[kernel.filesystem.008]
check_id = "L-KERNEL-FS-001"
check_name = "nfs"
check_skip = true
check_set = false
check_type = "filesystem"
cis = ""
disa = ""
mitre_tec = []
mitre_tac = []
mitre_mit = []
stig = ""
source = ""

[kernel.filesystem.009]
check_id = "L-KERNEL-FS-001"
check_name = "nfsv3"
check_skip = true
check_set = false
check_type = "filesystem"
cis = ""
disa = ""
mitre_tec = []
mitre_tac = []
mitre_mit = []
stig = ""
source = ""

[kernel.filesystem.010]
check_id = "L-KERNEL-FS-001"
check_name = "squashfs"
check_skip = false
check_set = true
check_type = "filesystem"
cis = "level-2"
disa = ""
mitre_tec = ["T1005", "T1005.000"]
mitre_tac = ["TA0005"]
mitre_mit = ["M1050"]
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-7"

[kernel.filesystem.011]
check_id = "L-KERNEL-FS-001"
check_name = "udf"
check_skip = false
check_set = true
check_type = "filesystem"
cis = "level-2"
disa = ""
mitre_tec = ["T1005", "T1005.000"]
mitre_tac = ["TA0005"]
mitre_mit = ["M1050"]
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-7"

[kernel.filesystem.012]
check_id = "L-KERNEL-FS-001"
check_name = "usb-storage"
check_skip = false
check_set = true
check_type = "filesystem"
cis = "level-1"
disa = ""
mitre_tec = ["T1052", "T1052.001", "T1091", "T1091.000", "T1200", "T1200.000"]
mitre_tac = ["TA0001", "TA0010"]
mitre_mit = ["M1034"]
stig = ""
source = "NIST SP 800-53 Rev. 5: SI-3"

[kernel.filesystem.013]
check_id = "L-KERNEL-FS-001"
check_name = "vfat"
check_skip = false
check_set = false
check_type = "filesystem"
cis = ""
disa = ""
mitre_tec = []
mitre_tac = []
mitre_mit = []
stig = ""
source = ""

#################################################
# Module Checks
#################################################
[kernel.module]
sub_category_id = "MOD"
sub_category_name = "Module"
sub_category_skip = false
sub_category_set = true

[kernel.module.001]
check_id = "L-KERNEL-MOD-001"
check_name = "dccp"
check_skip = false
check_set = true
check_type = "module"
cis = "level-2"
disa = ""
mitre_tec = ['T1068', 'T1068.000', 'T1210', 'T1210.000']
mitre_tac = ['TA0008']
mitre_mit = ['M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: SI-4, CM-7"

[kernel.module.002]
check_id = "L-KERNEL-MOD-001"
check_name = "rds"
check_skip = false
check_set = true
check_type = "module"
cis = "level-2"
disa = ""
mitre_tec = ['T1068', 'T1068.000', 'T1210', 'T1210.000']
mitre_tac = ['TA0008']
mitre_mit = ['M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: SI-4, CM-7"

[kernel.module.003]
check_id = "L-KERNEL-MOD-001"
check_name = "sctp"
check_skip = false
check_set = true
check_type = "module"
cis = "level-2"
disa = ""
mitre_tec = ['T1068', 'T1068.000', 'T1210', 'T1210.000']
mitre_tac = ['TA0008']
mitre_mit = ['M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: SI-4, CM-7"

[kernel.module.004]
check_id = "L-KERNEL-MOD-001"
check_name = "tipc"
check_skip = false
check_set = true
check_type = "module"
cis = "level-2"
disa = ""
mitre_tec = ['T1068', 'T1068.000', 'T1210', 'T1210.000']
mitre_tac = ['TA0008']
mitre_mit = ['M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: SI-4, CM-7"

#################################################
# Parameter Checks
#################################################
[kernel.parameter]
sub_category_id = "PARAM"
sub_category_name = "Parameter"
sub_category_skip = false
sub_category_set = true

[kernel.parameter.001]
check_id = "L-KERNEL-PARAM-001"
check_name = "aslr"
check_skip = false
check_set = true
check_type = "parameter"
setting = "kernel.randomize_va_space = 2"
cis = "level-1"
disa = "CCI-000366"
mitre_tec = ['T1068', 'T1068.000']
mitre_tac = ['TA0002']
mitre_mit = ['M1050']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-6"

[kernel.parameter.002]
check_id = "L-KERNEL-PARAM-001"
check_name = "ptrace"
check_skip = false
check_set = true
check_type = "parameter"
setting = "kernel.yama.ptrace_scope = 1"
cis = "level-1"
disa = ""
mitre_tec = ['T1055.008']
mitre_tac = ['TA0005']
mitre_mit = ['M1040']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-6"


#################################################
# Network Checks
#################################################
[kernel.network]
sub_category_id = "NET"
sub_category_name = "Network"
sub_category_skip = false
sub_category_set = true

# IPv4
[kernel.network.001]
check_id = "L-KERNEL-NET-001"
check_name = "IPv4 IP Forward"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv4.ip_forward = 0"
cis = "level-1"
disa = ""
mitre_tec = ['T1557', 'T1557.000']
mitre_tac = ['TA0006', 'TA0009']
mitre_mit = ['M1030', 'M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.002a]
check_id = "L-KERNEL-NET-001"
check_name = "IPv4 Send Redirects (All)"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv4.conf.all.send_redirects = 0"
cis = "level-1"
disa = ""
mitre_tec = ['T1557', 'T1557.000']
mitre_tac = ['TA0006', 'TA0009']
mitre_mit = ['M1030', 'M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.002b]
check_id = "L-KERNEL-NET-001"
check_name = "IPv4 Send Redirects (Default)"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv4.conf.default.send_redirects = 0"
cis = "level-1"
disa = ""
mitre_tec = ['T1557', 'T1557.000']
mitre_tac = ['TA0006', 'TA0009']
mitre_mit = ['M1030', 'M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.003a]
check_id = "L-KERNEL-NET-001"
check_name = "IPv4 Accept Source Route (All)"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv4.conf.all.accept_source_route = 0"
cis = "level-1"
disa = ""
mitre_tec = ['T1590', 'T1590.005']
mitre_tac = ['TA0007']
mitre_mit = []
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.003b]
check_id = "L-KERNEL-NET-001"
check_name = "IPv4 Accept Source Route (Default)"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv4.conf.default.accept_source_route = 0"
cis = "level-1"
disa = ""
mitre_tec = ['T1590', 'T1590.005']
mitre_tac = ['TA0007']
mitre_mit = []
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.004a]
check_id = "L-KERNEL-NET-001"
check_name = "IPv4 Accept Redirects (All)"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv4.conf.all.accept_redirects = 0"
cis = "level-1"
disa = ""
mitre_tec = ['T1557', 'T1557.000']
mitre_tac = ['TA0006', 'TA0009']
mitre_mit = ['M1030', 'M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.004b]
check_id = "L-KERNEL-NET-001"
check_name = "IPv4 Accept Redirects (Default)"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv4.conf.default.accept_redirects = 0"
cis = "level-1"
disa = ""
mitre_tec = ['T1557', 'T1557.000']
mitre_tac = ['TA0006', 'TA0009']
mitre_mit = ['M1030', 'M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.005a]
check_id = "L-KERNEL-NET-001"
check_name = "IPv4 Secure Redirects (All)"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv4.conf.all.secure_redirects = 0"
cis = "level-1"
disa = ""
mitre_tec = ['T1557', 'T1557.000']
mitre_tac = ['TA0006', 'TA0009']
mitre_mit = ['M1030', 'M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.005b]
check_id = "L-KERNEL-NET-001"
check_name = "IPv4 Secure Redirects (Default)"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv4.conf.default.secure_redirects = 0"
cis = "level-1"
disa = ""
mitre_tec = ['T1557', 'T1557.000']
mitre_tac = ['TA0006', 'TA0009']
mitre_mit = ['M1030', 'M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.006a]
check_id = "L-KERNEL-NET-001"
check_name = "IPv4 Log Martians (All)"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv4.conf.all.log_martians = 1"
cis = "level-1"
disa = ""
mitre_tec = ['T1562', 'T1562.006']
mitre_tac = ['TA0005']
mitre_mit = []
stig = ""
source = "NIST SP 800-53 Rev. 5: AU-3"

[kernel.network.006b]
check_id = "L-KERNEL-NET-001"
check_name = "IPv4 Log Martians (Default)"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv4.conf.default.log_martians = 1"
cis = "level-1"
disa = ""
mitre_tec = ['T1562', 'T1562.006']
mitre_tac = ['TA0005']
mitre_mit = []
stig = ""
source = "NIST SP 800-53 Rev. 5: AU-3"

[kernel.network.007]
check_id = "L-KERNEL-NET-001"
check_name = "IPv4 ICMP Ignore Broadcasts"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv4.icmp_echo_ignore_broadcasts = 1"
cis = "level-1"
disa = ""
mitre_tec = ['T1498', 'T1498.001']
mitre_tac = ['TA0040']
mitre_mit = ['M1037']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.008]
check_id = "L-KERNEL-NET-001"
check_name = "IPv4 Ignore Bogue Responses"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv4.icmp_ignore_bogus_error_responses = 1"
cis = "level-1"
disa = ""
mitre_tec = ['T1562', 'T1562.006']
mitre_tac = ['TA0040']
mitre_mit = ['M1053']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.009a]
check_id = "L-KERNEL-NET-001"
check_name = "IPv4 Reverse Path Filter (All)"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv4.conf.all.rp_filter = 1"
cis = "level-1"
disa = ""
mitre_tec = ['T1557', 'T1557.000']
mitre_tac = ['TA0006', 'TA0009']
mitre_mit = ['M1030', 'M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5"

[kernel.network.009b]
check_id = "L-KERNEL-NET-001"
check_name = "IPv4 Reverse Path Filter (Default)"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv4.conf.default.rp_filter = 1"
cis = "level-1"
disa = ""
mitre_tec = ['T1557', 'T1557.000']
mitre_tac = ['TA0006', 'TA0009']
mitre_mit = ['M1030', 'M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5"

[kernel.network.010]
check_id = "L-KERNEL-NET-001"
check_name = "IPv4 TCP Syn Cookies"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv4.tcp_syncookies = 1"
cis = "level-1"
disa = ""
mitre_tec = ['T1499', 'T1499.001']
mitre_tac = ['TA0040']
mitre_mit = ['M1037']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5"

# IPv6
[kernel.network.101]
check_id = "L-KERNEL-NET-001"
check_name = "IPv6 Forwarding (All)"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv6.conf.all.forwarding = 0"
cis = "level-1"
disa = ""
mitre_tec = ['T1557', 'T1557.000']
mitre_tac = ['TA0006', 'TA0009']
mitre_mit = ['M1030', 'M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.102a]
check_id = "L-KERNEL-NET-001"
check_name = "IPv6 Accept Source Route (All)"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv6.conf.all.accept_source_route = 0"
cis = "level-1"
disa = ""
mitre_tec = ['T1590', 'T1590.005']
mitre_tac = ['TA0007']
mitre_mit = []
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.102b]
check_id = "L-KERNEL-NET-001"
check_name = "IPv6 Accept Source Route (Default)"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv6.conf.default.accept_source_route = 0"
cis = "level-1"
disa = ""
mitre_tec = ['T1590', 'T1590.005']
mitre_tac = ['TA0007']
mitre_mit = []
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.103a]
check_id = "L-KERNEL-NET-001"
check_name = "IPv6 Accept Redirects (All)"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv6.conf.all.accept_redirects = 0"
cis = "level-1"
disa = ""
mitre_tec = ['T1557', 'T1557.000']
mitre_tac = ['TA0006', 'TA0009']
mitre_mit = ['M1030', 'M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.103b]
check_id = "L-KERNEL-NET-001"
check_name = "IPv6 Accept Redirects (Default)"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv6.conf.default.accept_redirects = 0"
cis = "level-1"
disa = ""
mitre_tec = ['T1557', 'T1557.000']
mitre_tac = ['TA0006', 'TA0009']
mitre_mit = ['M1030', 'M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[kernel.network.104a]
check_id = "L-KERNEL-NET-001"
check_name = "IPv6 Accept Router Avertisements (All)"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv6.conf.all.accept_ra = 0"
cis = "level-1"
disa = ""
mitre_tec = ['T1557', 'T1557.000']
mitre_tac = ['TA0006', 'TA0009']
mitre_mit = ['M1030', 'M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5"

[kernel.network.104b]
check_id = "L-KERNEL-NET-001"
check_name = "IPv6 Accept Router Avertisements (Default)"
check_skip = false
check_set = true
check_type = "network"
setting = "net.ipv6.conf.default.accept_ra = 0"
cis = "level-1"
disa = ""
mitre_tec = ['T1557', 'T1557.000']
mitre_tac = ['TA0006', 'TA0009']
mitre_mit = ['M1030', 'M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5"

#################################################
# System Hardening
#################################################
[system]
category_id = "SYSTEM"
category_name = "System"
category_skip = false
category_set = true

[system.aide]
sub_category_id = "AIDE"
sub_category_name = "Aide"
sub_category_skip = false
sub_category_set = true

[system.aide.001a]
check_id = "L-SYSTEM-AIDE-001"
check_name = "aide"
check_skip = false
check_set = true
check_type = "package"
cis = "level-1"
disa = ""
mitre_tec = ['T1565', 'T1565.001']
mitre_tac = ['TA0001']
mitre_mit = ['M1022']
stig = ""
source = "NIST SP 800-53 Rev. 5: AU-2"

[system.aide.002a]
check_id = "L-SYSTEM-AIDE-001"
check_name = "aide service enabled"
check_skip = false
check_set = true
check_type = "service"
svc_name = "aidecheck.service"
cis = "level-1"
disa = ""
mitre_tec = ['T1036', 'T1036.005']
mitre_tac = ['TA0040']
mitre_mit = ['M1022']
stig = ""
source = "NIST SP 800-53 Rev. 5: AU-2"

[system.aide.002b]
check_id = "L-SYSTEM-AIDE-001"
check_name = "aide timer enabled"
check_skip = false
check_set = true
check_type = "service"
svc_name = "aidecheck.timer"
cis = "level-1"
disa = ""
mitre_tec = ['T1036', 'T1036.005']
mitre_tac = ['TA0040']
mitre_mit = ['M1022']
stig = ""
source = "NIST SP 800-53 Rev. 5: AU-2"

[system.aide.003a]
check_id = "L-SYSTEM-AIDE-001"
check_name = "aide scheduled"
check_skip = false
check_set = true
check_type = "command"
command = "grep -Ers '^([^#]+\\s+)?(\\/usr\\/s?bin\\/|^\\s*)aide(\\.wrapper)?\\s(--?\\S+\\s)*(--(check|update)|\\$AIDEARGS)\\b' /etc/cron.* /etc/crontab /var/spool/cron/"
setting = ""
cis = "level-1"
disa = ""
mitre_tec = ['T1036', 'T1036.005']
mitre_tac = ['TA0040']
mitre_mit = ['M1022']
stig = ""
source = "NIST SP 800-53 Rev. 5: AU-2"

[system.audit]
sub_category_id = "AUDIT"
sub_category_name = "Audit"
sub_category_skip = false
sub_category_set = true

[system.audit.001a]
check_id = "L-SYSTEM-AUDIT-001"
check_name = "audit"
check_skip = false
check_set = true
check_type = "package"
cis = ""
disa = ""
mitre_tec = []
mitre_tac = []
mitre_mit = []
stig = ""
source = ""

[system.audit.002a]
check_id = "L-SYSTEM-AUDIT-001"
check_name = "audit"
check_skip = false
check_set = true
check_type = "service"
svc_name = "auditd.service"
cis = ""
disa = ""
mitre_tec = []
mitre_tac = []
mitre_mit = []
stig = ""
source = ""

[system.banner]
sub_category_id = "BANN"
sub_category_name = "Banner"
sub_category_skip = false
sub_category_set = true

[system.banner.001a]
check_id = "L-SYSTEM-BANN-001"
check_name = "/etc/motd Configured"
check_skip = false
check_set = true
check_type = "command"
command = "cat /etc/motd"
setting = "review"
cis = "level-1"
disa = ""
mitre_tec = ['T1082', 'T1082.000', 'T1592', 'T1592.004']
mitre_tac = ['TA0007']
mitre_mit = []
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-3"

[system.banner.001b]
check_id = "L-SYSTEM-BANN-001"
check_name = "/etc/motd uname Info (FIX)"
check_skip = false
check_set = true
check_type = "command"
command = "grep -E -i \"(\\\\\\v|\\\\\\r|\\\\\\m|\\\\\\s|$(grep '^ID=' /etc/os-release | cut -d= -f2 | sed -e 's/\"//g'))\" /etc/motd"
setting = "review"
cis = "level-1"
disa = ""
mitre_tec = ['T1082', 'T1082.000', 'T1592', 'T1592.004']
mitre_tac = ['TA0007']
mitre_mit = []
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-3"

[system.banner.001c]
check_id = "L-SYSTEM-BANN-001"
check_name = "/etc/motd Permissions Configured"
check_skip = false
check_set = true
check_type = "file"
path = "/etc/motd"
permissions = "644"
owner = "0"
group = "0"
cis = "level-1"
disa = ""
mitre_tec = ['T1222', 'T1222.002']
mitre_tac = ['TA0005']
mitre_mit = ['M1022']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3, MP-2"

[system.banner.002a]
check_id = "L-SYSTEM-BANN-001"
check_name = "/etc/issue Configured"
check_skip = false
check_set = true
check_type = "command"
command = "cat /etc/issue"
setting = "review"
cis = "level-1"
disa = ""
mitre_tec = ['T1082', 'T1082.000', 'T1592', 'T1592.004']
mitre_tac = ['TA0007']
mitre_mit = []
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-6, CM-1, CM-3"

[system.banner.002b]
check_id = "L-SYSTEM-BANN-001"
check_name = "/etc/issue uname Info (FIX)"
check_skip = false
check_set = true
check_type = "command"
command = "grep -E -i \"(\\\\v|\\\r|\\\\m|\\\\s|$(grep '^ID=' /etc/os-release | cut -d= -f2 | sed -e 's/\"//g'))\" /etc/issue"
setting = "review"
path = "/etc/issue"
cis = "level-1"
disa = ""
mitre_tec = ['T1222', 'T1222.002']
mitre_tac = ['TA0005']
mitre_mit = ['M1022']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3, MP-2"

[system.banner.002c]
check_id = "L-SYSTEM-BANN-001"
check_name = "/etc/issue Permissions Configured"
check_skip = false
check_set = true
check_type = "file"
path = "/etc/issue"
permissions = "644"
owner = "0"
group = "0"
cis = "level-1"
disa = ""
mitre_tec = ['T1222', 'T1222.002']
mitre_tac = ['TA0005']
mitre_mit = ['M1022']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3, MP-2"

[system.banner.003a]
check_id = "L-SYSTEM-BANN-001"
check_name = "/etc/issue.net Configured"
check_skip = false
check_set = true
check_type = "command"
command = "cat /etc/issue.net"
setting = "review"
cis = "level-1"
disa = ""
mitre_tec = ['T1018', 'T1018.000', 'T1082', 'T1082.000', 'T1592', 'T1592.004']
mitre_tac = ['TA0007']
mitre_mit = []
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-6, CM-1, CM-3"

[system.banner.003b]
check_id = "L-SYSTEM-BANN-001"
check_name = "/etc/issue.net uname Info (FIX)"
check_skip = false
check_set = true
check_type = "command"
command = "grep -E -i \"(\\\\\\v|\\\\\\r|\\\\\\m|\\\\\\s|$(grep '^ID=' /etc/os-release | cut -d= -f2 | sed -e 's/\"//g'))\" /etc/issue.net"
setting = "review"
path = "/etc/issue.net"
cis = "level-1"
disa = ""
mitre_tec = ['T1222', 'T1222.002']
mitre_tac = ['TA0005']
mitre_mit = ['M1022']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3, MP-2"

[system.banner.003c]
check_id = "L-SYSTEM-BANN-001"
check_name = "/etc/issue.net Permissions Configured"
check_skip = false
check_set = true
check_type = "file"
path = "/etc/issue.net"
permissions = "644"
owner = "0"
group = "0"
cis = "level-1"
disa = ""
mitre_tec = ['T1222', 'T1222.002']
mitre_tac = ['TA0005']
mitre_mit = ['M1022']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3, MP-2"


[system.cron]
sub_category_id = "CRON"
sub_category_name = "Cron"
sub_category_skip = false
sub_category_set = true

[system.cron.001a]
check_id = "L-SYSTEM-CRON-001"
check_name = "cron"
check_skip = false
check_set = true
check_type = "package"
cis = "level-1"
disa = ""
mitre_tec = ['T1562', 'T1562.001']
mitre_tac = ['TA0005']
mitre_mit = ['M1018']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[system.cron.001b]
check_id = "L-SYSTEM-CRON-001"
check_name = "cronie"
check_skip = false
check_set = true
check_type = "package"
cis = "level-1"
disa = ""
mitre_tec = ['T1562', 'T1562.001']
mitre_tac = ['TA0005']
mitre_mit = ['M1018']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[system.cron.002a]
check_id = "L-SYSTEM-CRON-001"
check_name = "cron daemon enabled"
check_skip = false
check_set = true
check_type = "service"
svc_name = "crond"
cis = "level-1"
disa = ""
mitre_tec = ['T1562', 'T1562.001']
mitre_tac = ['TA0005']
mitre_mit = ['M1018']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[system.cron.003a]
check_id = "L-SYSTEM-CRON-001"
check_name = "/etc/crontab"
check_skip = false
check_set = true
check_type = "file"
path = "/etc/crontab"
permissions = "600"
owner = "0"
group = "0"
cis = "level-1"
disa = ""
mitre_tec = ['T1053', 'T1053.003']
mitre_tac = ['TA0002', 'TA0007']
mitre_mit = ['M1018']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3, MP-2"

[system.cron.004a]
check_id = "L-SYSTEM-CRON-001"
check_name = "/etc/cron.hourly"
check_skip = false
check_set = true
check_type = "dir"
path = "/etc/cron.hourly"
permissions = "700"
owner = "0"
group = "0"
cis = "level-1"
disa = ""
mitre_tec = ['T1053', 'T1053.003']
mitre_tac = ['TA0002', 'TA0007']
mitre_mit = ['M1018']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3, MP-2"

[system.cron.005a]
check_id = "L-SYSTEM-CRON-001"
check_name = "/etc/cron.daily"
check_skip = false
check_set = true
check_type = "dir"
path = "/etc/cron.daily"
permissions = "700"
owner = "0"
group = "0"
cis = "level-1"
disa = ""
mitre_tec = ['T1053', 'T1053.003']
mitre_tac = ['TA0002', 'TA0007']
mitre_mit = ['M1018']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3, MP-2"

[system.cron.006a]
check_id = "L-SYSTEM-CRON-001"
check_name = "/etc/cron.weekly"
check_skip = false
check_set = true
check_type = "dir"
path = "/etc/cron.weekly"
permissions = "700"
owner = "0"
group = "0"
cis = "level-1"
disa = ""
mitre_tec = ['T1053', 'T1053.003']
mitre_tac = ['TA0002', 'TA0007']
mitre_mit = ['M1018']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3, MP-2"

[system.cron.007a]
check_id = "L-SYSTEM-CRON-001"
check_name = "/etc/cron.monthly"
check_skip = false
check_set = true
check_type = "dir"
path = "/etc/cron.monthly"
permissions = "700"
owner = "0"
group = "0"
cis = "level-1"
disa = ""
mitre_tec = ['T1053', 'T1053.003']
mitre_tac = ['TA0002', 'TA0007']
mitre_mit = ['M1018']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3, MP-2"

[system.cron.008a]
check_id = "L-SYSTEM-CRON-001"
check_name = "/etc/cron.d"
check_skip = false
check_set = true
check_type = "dir"
path = "/etc/cron.d"
permissions = "700"
owner = "0"
group = "0"
cis = "level-1"
disa = ""
mitre_tec = ['T1053', 'T1053.003']
mitre_tac = ['TA0002', 'TA0007']
mitre_mit = ['M1022']                        # Why is this one different?
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3, MP-2"

[system.cron.009a]
check_id = "L-SYSTEM-CRON-001"
check_name = "/etc/cron.allow"
check_skip = false
check_set = true
check_type = "file"
path = "/etc/cron.allow"
permissions = "700"
owner = "0"
group = "0"
cis = "level-1"
disa = ""
mitre_tec = ['T1053', 'T1053.003']
mitre_tac = ['TA0002', 'TA0007']
mitre_mit = ['M1022']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3, MP-2"

[system.cron.009b]
check_id = "L-SYSTEM-CRON-001"
check_name = "/etc/cron.deny"
check_skip = false
check_set = true
check_type = "file"
path = "/etc/cron.deny"
permissions = "700"
owner = "0"
group = "0"
cis = "level-1"
disa = ""
mitre_tec = ['T1053', 'T1053.003']
mitre_tac = ['TA0002', 'TA0007']
mitre_mit = ['M1022']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3, MP-2"

[system.cron.010a]
check_id = "L-SYSTEM-CRON-001"
check_name = "at"
check_skip = false
check_set = true
check_type = "package"
cis = "level-1"
disa = ""
mitre_tec = ['T1562', 'T1562.001']
mitre_tac = ['TA0005']
mitre_mit = ['M1018']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[system.cron.011a]
check_id = "L-SYSTEM-CRON-001"
check_name = "/etc/at.allow used"
check_skip = false
check_set = true
check_type = "file"
path = "/etc/at.allow"
permissions = "700"
owner = "0"
group = "0"
cis = "level-1"
disa = ""
mitre_tec = ['T1053', 'T1053.003']
mitre_tac = ['TA0002', 'TA0007']
mitre_mit = ['M1026']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3, MP-2"

[system.cron.011b]
check_id = "L-SYSTEM-CRON-001"
check_name = "/etc/at.deny used"
check_skip = false
check_set = true
check_type = "file"
path = "/etc/at.deny"
permissions = "700"
owner = "0"
group = "0"
cis = "level-1"
disa = ""
mitre_tec = ['T1053', 'T1053.003']
mitre_tac = ['TA0002', 'TA0007']
mitre_mit = ['M1026']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3, MP-2"

[system.ssh]
sub_category_id = "SSH"
sub_category_name = "OpenSSH"
sub_category_skip = false
sub_category_set = true

[system.ssh.001a]
check_id = "L-SYSTEM-SSH-001"
check_name = "openssh-server"
check_skip = false
check_set = true
check_type = "package"
cis = ""
disa = ""
mitre_tec = []
mitre_tac = []
mitre_mit = []
stig = ""
source = ""

[system.ssh.002a]
check_id = "L-SYSTEM-SSH-001"
check_name = "/etc/ssh/sshd_config"
check_skip = false
check_set = true
check_type = "file"
path = "/etc/ssh/sshd_config"
permissions = "600"
owner = "0"
group = "0"
cis = "level-1"
disa = ""
mitre_tec = ['T1098', 'T1098.004', 'T1543', 'T1543.002']
mitre_tac = ['TA0005']
mitre_mit = ['M1022']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3. MP-2"

[system.ssh.003a]
check_id = "L-SYSTEM-SSH-001"
check_name = "SSH Private Host Key Files"
check_skip = false
check_set = true
check_type = "keys"
check_file_type = "private key"
path = "/etc/ssh"
permissions = "600"
owner = "0"
group = "0"
cis = "level-1"
disa = ""
mitre_tec = ['T1552', 'T1552.004']
mitre_tac = ['TA0003', 'TA0006']
mitre_mit = ['M1022']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3. MP-2"

[system.ssh.004a]
check_id = "L-SYSTEM-SSH-001"
check_name = "SSH Public Host Key Files"
check_skip = false
check_set = true
check_type = "keys"
check_file_type = "public key"
path = "/etc/ssh"
permissions = "644"
owner = "0"
group = "0"
cis = "level-1"
disa = ""
mitre_tec = ['T1552', 'T1552.004']
mitre_tac = ['TA0003', 'TA0006']
mitre_mit = ['M1022']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3. MP-2"

[system.ssh.005a]
check_id = "L-SYSTEM-SSH-001"
check_name = "SSH Access Limited"
check_skip = false
check_set = true
check_type = "command"
command = "sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep -Pi '^\\h*(allow|deny)(users|groups)\\h+\\H+(\\h+.*)?$'"
setting = ""
cis = "level-1"
disa = ""
mitre_tec = ['T1021', 'T1021.004']
mitre_tac = ['TA0008']
mitre_mit = ['M1018']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3. MP-2"

[system.ssh.006a]
check_id = "L-SYSTEM-SSH-001"
check_name = "SSH LogLevel Configured"
check_skip = false
check_set = true
check_type = "command"
command = "sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep loglevel"
setting = "LogLevel INFO"                                                                                                              # loglevel INFO or loglevel VERBOSE
cis = "level-1"
disa = ""
mitre_tec = ['T1562', 'T1562.006']
mitre_tac = ['TA0005']
mitre_mit = []
stig = ""
source = "NIST SP 800-53 Rev. 5: AU-2, AU-12, SI-5"

[system.ssh.007a]
check_id = "L-SYSTEM-SSH-001"
check_name = "SSH PAM Enabled"
check_skip = false
check_set = true
check_type = "command"
command = "sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep -i usepam"
setting = "UsePAM yes"
cis = "level-1"
disa = ""
mitre_tec = ['T1021', 'T1021.004']
mitre_tac = ['TA0001']
mitre_mit = ['M1035']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5"

[system.ssh.008a]
check_id = "L-SYSTEM-SSH-001"
check_name = "SSH Root Login Disabled"
check_skip = false
check_set = true
check_type = "command"
command = "sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep permitrootlogin"
setting = "PermitRootLogin no"
cis = "level-1"
disa = ""
mitre_tec = ['T1078']
mitre_tac = ['TA0001']
mitre_mit = ['M1026']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-6"

[system.ssh.009a]
check_id = "L-SYSTEM-SSH-001"
check_name = "SSH Host Based Auth Disabled"
check_skip = false
check_set = true
check_type = "command"
command = "sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep hostbasedauthentication"
setting = "HostbasedAuthentication no"
cis = "level-1"
disa = ""
mitre_tec = ['T1078', 'T1078.001', 'T1078.003']
mitre_tac = ['TA0008']
mitre_mit = ['M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5"

[system.ssh.010a]
check_id = "L-SYSTEM-SSH-001"
check_name = "SSH Permit Empty Passwords Disabled"
check_skip = false
check_set = true
check_type = "command"
command = "sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep permitemptypasswords"
setting = "PermitEmptyPasswords no"
cis = "level-1"
disa = ""
mitre_tec = ['T1021', 'T1021.000']
mitre_tac = ['TA0008']
mitre_mit = ['M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5"

[system.ssh.011a]
check_id = "L-SYSTEM-SSH-001"
check_name = "SSH Permit User Environment Disabled"
check_skip = false
check_set = true
check_type = "command"
command = "sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep permituserenvironment"
setting = "PermitUserEnvironment no"
cis = "level-1"
disa = ""
mitre_tec = ['T1021', 'T1021.000']
mitre_tac = ['TA0008']
mitre_mit = ['M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5"

[system.ssh.012a]
check_id = "L-SYSTEM-SSH-001"
check_name = "SSH Ignore Rhosts Enabled"
check_skip = false
check_set = true
check_type = "command"
command = "sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep ignorerhosts"
setting = "IgnoreRhosts yes"
cis = "level-1"
disa = ""
mitre_tec = ['T1078', 'T1078.001', 'T1078.003']
mitre_tac = ['TA0001']
mitre_mit = ['M1027']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5"

[system.ssh.013a]
check_id = "L-SYSTEM-SSH-001"
check_name = "SSH X11 Forwarding Disabled"
check_skip = false
check_set = true
check_type = "command"
command = "sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep -i x11forwarding"
setting = "X11Forwarding no"
cis = "level-2"
disa = ""
mitre_tec = ['T1210', 'T1210.000']
mitre_tac = ['TA0008']
mitre_mit = ['M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-7"

[system.ssh.014a]
check_id = "L-SYSTEM-SSH-001"
check_name = "SSH Allow TCP Forwarding Disabled"
check_skip = false
check_set = true
check_type = "command"
command = "sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep -i allowtcpforwarding"
setting = "AllowTcpForwarding no"
cis = "level-2"
disa = ""
mitre_tec = ['T1048', 'T1048.002', 'T1572', 'T1572.000']
mitre_tac = ['TA0008']
mitre_mit = ['M1042']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5"

[system.ssh.015a]
check_id = "L-SYSTEM-SSH-001"
check_name = "System Wide Crypto Policy No Override"
check_skip = false
check_set = true
check_type = "command"
command = "grep -i '^\\s*CRYPTO_POLICY=' /etc/sysconfig/sshd"
setting = ""
cis = "level-1"
disa = ""
mitre_tec = []
mitre_tac = []
mitre_mit = []
stig = ""
source = "NIST SP 800-53 Rev. 5: SC-8, IA-5, AC-17"

[system.ssh.016a]
check_id = "L-SYSTEM-SSH-001"
check_name = "SSH Warning Banner Configured"
check_skip = false
check_set = true
check_type = "command"
command = "sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep banner"
setting = "Banner /etc/issue.net"
cis = "level-1"
disa = ""
mitre_tec = ['T1082', 'T1082.000', 'T1592', 'T1592.004']
mitre_tac = ['TA0001', 'TA0007']
mitre_mit = ['M1035']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5"

[system.ssh.017a]
check_id = "L-SYSTEM-SSH-001"
check_name = "SSH Max Auth Retries 4 or Less"
check_skip = false
check_set = true
check_type = "command"
command = "sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep maxauthtries"
setting = "MaxAuthTries 4"
cis = "level-1"
disa = ""
mitre_tec = ['T1110', 'T1110.001', 'T1110.003']
mitre_tac = ['TA0006']
mitre_mit = ['M1036']
stig = ""
source = "NIST SP 800-53 Rev. 5: AU-3"

[system.ssh.018a]
check_id = "L-SYSTEM-SSH-001"
check_name = "SSH Max Startups"
check_skip = false
check_set = true
check_type = "command"
command = "sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep -i maxstartups"
setting = "MaxStartups 10:30:60"
cis = "level-1"
disa = ""
mitre_tec = ['T1499', 'T1499.002']
mitre_tac = ['TA0040']
mitre_mit = ['M1036']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5"

[system.ssh.019a]
check_id = "L-SYSTEM-SSH-001"
check_name = "SSH Max Sessions 10 or Less"
check_skip = false
check_set = true
check_type = "command"
command = "sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep -i maxsessions"
setting = "MaxSessions 10"
cis = "level-1"
disa = ""
mitre_tec = ['T1499', 'T1499.002']
mitre_tac = ['TA0040']
mitre_mit = ['M1036']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5"

[system.ssh.020a]
check_id = "L-SYSTEM-SSH-001"
check_name = "SSH Login Grace Time 1 min or Less"
check_skip = false
check_set = true
check_type = "command"
command = "sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep logingracetime"
setting = "LoginGraceTime 60"
cis = "level-1"
disa = ""
mitre_tec = ['T1110', 'T1110.001', 'T1110.003', 'T1110.004']
mitre_tac = ['TA0006']
mitre_mit = ['M1036']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-6"

[system.ssh.021a]
check_id = "L-SYSTEM-SSH-001"
check_name = "SSH Idle Timeout Interval Configured"
check_skip = false
check_set = true
check_type = "command"
command = "sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep clientaliveinterval"
setting = "ClientAliveInterval 15"
cis = "level-1"
disa = ""
mitre_tec = ['T1078', 'T1078.001', 'T1078.002', 'T1078.003']
mitre_tac = ['TA0001']
mitre_mit = ['M1026']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5"

[system.ssh.021b]
check_id = "L-SYSTEM-SSH-001"
check_name = "SSH Idle Timeout Max Configured"
check_skip = false
check_set = true
check_type = "command"
command = "sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep clientalivecountmax"
setting = "ClientAliveCountMax 3"
cis = "level-1"
disa = ""
mitre_tec = ['T1078', 'T1078.001', 'T1078.002', 'T1078.003']
mitre_tac = ['TA0001']
mitre_mit = ['M1026']
stig = ""
source = "NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5"


[system.sudo]
sub_category_id = "SUDO"
sub_category_name = "Sudo"
sub_category_skip = false
sub_category_set = true

[system.sudo.001a]
check_id = "L-SYSTEM-SUDO-001"
check_name = "sudo"
check_skip = false
check_set = true
check_type = "package"
cis = "level-1"
disa = ""
mitre_tec = ['T1548']
mitre_tac = ['TA0004']
mitre_mit = ['M1026']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-6"

[system.sudo.002a]
check_id = "L-SYSTEM-SSH-001"
check_name = "Sudo commands use pty"
check_skip = false
check_set = true
check_type = "command"
command = "grep -rPi '^\\h*Defaults\\h+([^#\\n\\r]+,)?use_pty(,\\h*\\h+\\h*)*\\h*(#.*)?$' /etc/sudoers*"
setting = "use_pty"
cis = "level-1"
disa = ""
mitre_tec = ['T1078', 'T1078.003', 'T1548', 'T1548.003']
mitre_tac = ['TA0001', 'TA0003']
mitre_mit = ['M1026', 'M1038']
stig = ""
source = ""

[system.sudo.003a]
check_id = "L-SYSTEM-SSH-001"
check_name = "Sudo log file exists"
check_skip = false
check_set = true
check_type = "command"
command = [
    'grep',
    '-rPsi',
    "\"^\\h*Defaults\\h+([^#]+,\\h*)?logfile\\h*=\\h*(\\\"|\\')?\\H+(\\\"|\\')?(,\\h*\\H+\\h*)*\\h*(#.*)?$\"",
    '/etc/sudoers*',
]
setting = "sudo.log"
cis = "level-1"
disa = ""
mitre_tec = ['T1562', 'T1562.006']
mitre_tac = ['TA0004']
mitre_mit = ['M1026']
stig = ""
source = ""

[system.sudo.004a]
check_id = "L-SYSTEM-SSH-001"
check_name = "Sudo Re-Auth Not Global Disabled"
check_skip = false
check_set = true
check_type = "command"
command = "grep -r \"^[^#].*\\!authenticate\" /etc/sudoers*"
setting = ""
cis = "level-1"
disa = ""
mitre_tec = ['T1548']
mitre_tac = ['TA0004']
mitre_mit = ['M1026']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-6"

[system.sudo.005a]
check_id = "L-SYSTEM-SSH-001"
check_name = "Sudo Timeout Configured (FIX)"
check_skip = false
check_set = true
check_type = "command"
command = "grep -roP \"timestamp_timeout=\\K[0-9]*\" /etc/sudoers*"
setting = ""
cis = "level-1"
disa = ""
mitre_tec = ['T1548']
mitre_tac = ['TA0004']
mitre_mit = ['M1026']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-6"

[system.sudo.006a]
check_id = "L-SYSTEM-SSH-001"
check_name = "Sudo Su Access Restricted (FIX)"
check_skip = false
check_set = true
check_type = "command"
command = "grep -Pi '^\\h*auth\\h+(?:required|requisite)\\h+pam_wheel\\.so\\h+(?:[^#\\n\\r]+\\h+)?((?!\\2)(use_uid\\b|group=\\H+\\b))\\h+(?:[^#\\n\\r]+\\h+)?((?!\\1)(use_uid\\b|group=\\H+\\b))(\\h+.*)?$' /etc/pam.d/su"
setting = "auth required"
cis = "level-1"
disa = ""
mitre_tec = ['T1078']
mitre_tac = ['TA0005']
mitre_mit = ['M1026']
stig = ""
source = "NIST SP 800-53 Rev. 5: AC-3. MP-2"
